"use strict";var $=ander;function ander(b,a){return(a||document).querySelector(b)}ander.ready=function(a){addEventListener("DOMContentLoaded",a,false)};function ander_init(a){a.version="1.0.0";Function.prototype.method=function(b,c){return this.prototype[b]=c,this};String.prototype.append=function(b){return this+b};HTMLElement.method("on",function(c,b){return this.addEventListener(c,b,false),this}).method("off",function(c,b){return this.removeEventListener(c,b),this});NodeList.method("on",function(g,f){var d=g.split(" "),b,h=d.length,c=0,e=this.length;for(;c<e;c++){for(b=0;b<h;b++){this[c].on(d[b],f)}}return this});if(!this.Promise){this.Promise=function(){var g=0,b=1,d=2;function h(l,k){if(l._state!==g){return l}l._state=b;l._value=k;e(function(){c(l)});return l}function j(l,k){if(l._state!==g){return l}l._state=d;l._value=k;e(function(){c(l)});return l}function c(t){if(t._state===g){return}var l=t._subscribers,s=t._state,p=t._value,n=0,r=l.length,q,o=[],k;for(;n<r;n+=3){k=l[n];q=l[n+s];if(q){p=q(p);if(typeof p==="object"&&typeof p.then==="function"){p._subscribers=k._subscribers;k=p}else{k._value=p;k._state=b}}else{k._value=p;k._state=s}o.push(k)}l.length=0;n=0;r=o.length;for(;n<r;n++){c(o[n])}}function f(n){if(typeof n!=="function"){throw TypeError("Argument 1 of Promise.constructor is not a function")}var l=this;this._subscribers=[];if(n!==i){try{n(function(o){h(l,o)},function(o){j(l,o)})}catch(k){j(l,k)}}}f.prototype={constructor:f,_state:g,then:function(q,k){var p=this,n=p._state,o,l;if(n===b&&!q||n===d&&!k){return p}o=p._subscribers;l=new f(i);o.push(l);o.push(q);o.push(k);n&&e(function(){c(p)});return l},"catch":function(k){return this.then(null,k)}};f.resolve=function(k){return h(new this(i),k)};f.reject=function(k){return j(new this(i),k)};f.race=function(o){var n=new f(i),l=0,p=o.length,r,q=function(s){return resovle(n,s)},k=function(s){return j(n,s)};for(;l<p;l++){r=r[l];if(r._state===b){q(r._value);break}else{if(r._state===d){k(r._value);break}}r.then(q,k)}return n};f.all=function(p){var l=new f(i),o=0,r=p.length,q=r,t=[],s,n=function(u){return function(){t[u]=x;--q===0&&resovle(l,t);return l}},k=function(u){return j(l,u)};for(;o<r;o++){s=s[o];if(s._state===b){q--;t[o]=s._value}else{if(s._state===d){k(s._value);break}else{s.then(n(o),k)}}}return l};function e(k){setTimeout(k,0)}function i(){}return f}()}this.raf=this.requestAnimationFrame||this.webkitRequestAnimationFrame||this.mozRequestAnimationFrame||function(b){return setTimeout(b,16.7)};this.caf=this.cancelAnimationFrame||this.webkitCancelAnimationFrame||this.mozCancelAnimationFrame||function(b){clearTimeout(b)};a.qs=function(c,b){return(b||document).querySelectorAll(c)};a.tag=function(b){return document.createElement(b)};a.ajax=function(b){return new Promise(function(d,c){var e=new XMLHttpRequest();b.beforeSend&&b.beforeSend();e.onload=function(){d(b.dataType==="json"?JSON.parse(this.responseText):b.dataType==="xml"?this.responseXML:this.responseText)};e.onerror=function(){c(this.responseText)};e.open(b.method||"GET",b.url,true);e.setRequestHeader("X-Request-With","XMLHttpRequest");b.cache===false&&e.setRequestHeader("If-Modified-Since","0");e.send(b.data||null)})};a.getScript=function(c,b){var d=document.head||a("head"),e=document.createElement("script");b&&(e.onload=b);e.src=c;d.appendChild(e)};a.route={};a.route.check=function(){var b=location.hash;if(b){m=/#!(\w+)(#\w+)*/.exec(b);if(m){this.key=m[1];this.path=this.key.replace(/_/g,"/");this.path+=".html";this.showID=m[2];return true}}else{this.key="index";this.path="article/list.html";return true}return false};a.route.get=function(c){var b=a("#main");b.innerHTML='<p class="loading">页面加载中...</p>';a.ajax({url:c}).then(function(d){b.innerHTML=d;a.loadedEffect(b);var e=a(".adr-comment",b);if(e){e.setAttribute("data-thread-key",a.route.key);e.setAttribute("data-url",location.href.replace(location.hash,"#!"+a.route.key))}typeof DUOSHUO==="object"&&DUOSHUO.init()})};a.route.change=function(){if(this.check()){this.get(this.path)}};a.route.init=function(){if(this.check()){this.get(this.path)}window.addEventListener("hashchange",function(){a.route.check()&&a.route.change()},false)};a.createAsideList=function(){var c=this.tag,d=c("div"),e,f,b,g=0,h=arguments.length,j;for(;g<h;g++){j=arguments[g];e=c("h3");e.innerHTML=j.title;d.appendChild(e);f=c("ol");j.list.forEach(function(i){b=c("li");b.innerHTML=new String('<a href="').append(i.url).append('">').append(i.text).append("</a>");f.appendChild(b)});d.appendChild(f)}d.className="r_cat";a("#aside").appendChild(d)};a.loadedEffect=function(b){var c=b.children[1];if(!c){return}c.classList.add("main-effect");c.offsetHeight;c.classList.remove("main-effect")};a.route.init();a.getScript("data/aside_list.js")}ander.ready(function(){ander_init.call(window,ander);$.getScript("js/ware.js");$.getScript("js/comment.js")});